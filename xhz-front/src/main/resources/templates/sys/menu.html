<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>菜单管理</title>
	<#include "/common/header.html">
</head>

<body>
	<div id="app" v-cloak>
		<el-card>
			<div slot="header">
				<span>
					<el-form ref="queryForm" :model="q" label-width="80px">
						<el-row>
							<el-col :span="4">
								<el-form-item prop="name" label="菜单名称">
									<el-input v-model="q.name" clearable></el-input>
								</el-form-item>
							</el-col>
							<el-col :span="4">
								<el-form-item prop="url" label="菜单URL">
									<el-input v-model="q.url" clearable></el-input>
								</el-form-item>
							</el-col>
							&nbsp;&nbsp;
							<el-button type="success" @click="query"><i class="fa fa-search"></i>&nbsp;查询</el-button>
							<el-button @click="handleReset('queryForm')"><i class="fa fa-reply"></i></i>&nbsp;重置</el-button>
						</el-row>
					</el-form>
				</span>
			</div>
			<el-button type="primary" @click="add"><i class="fa fa-plus"></i>&nbsp;添加</el-button>
			<el-button type="warning" @click="update"><i class="fa fa-pencil-square-o"></i>&nbsp;修改</el-button>
			<el-button type="danger" @click="del"><i class="fa fa-trash-o"></i>&nbsp;删除</el-button>
			<el-button type="success" @click="manageParms"><i class="fa fa-eye"></i>&nbsp;批量管理授权</el-button>
			<table class="layui-hide" id="menuTable" lay-filter="menuTable"></table>
		</el-card>
		<div id="menuDialog" class="layui-dialog">
			<el-card>
				<el-form @submit.native.prevent ref="menuForm" :rules="ruleValidate" :model="menu" label-width="80px">
					<el-row>
						<el-col :span="12">
							<el-form-item prop="type" label="类型">
								<template v-if="menu.type == 0">
									<span class="layui-badge layui-bg-green">目录</span>
								</template>
								<template v-if="menu.type == 1">
									<span class="layui-badge layui-bg-blue">菜单</span>
								</template>
								<template v-if="menu.type == 2">
									<span class="layui-badge layui-bg-orange">按钮</span>
								</template>
							</el-form-item>
						</el-col>
						<el-col :span="12">
							<el-form-item label="上级菜单">
								<span class="layui-badge layui-bg-cyan">{{menu.parentName}}</span>
							</el-form-item>
						</el-col>
					</el-row>
					<el-row>
						<el-form-item prop="name" label="名称">
							<el-input v-model.trim="menu.name" clearable placeholder="目录\菜单\按钮名称"></el-input>
						</el-form-item>
					</el-row>
					<el-row>
						<el-form-item v-if="menu.type == 1" prop="url" label="菜单URL">
							<el-input v-model.trim="menu.url" placeholder="例如：/{module}/{url}.html" clearable></el-input>
						</el-form-item>
					</el-row>
					<el-row>
						<el-form-item v-if="menu.type != 2" prop="icon" label="图标">
							<el-input v-model.trim="menu.icon" placeholder="粘贴图标代码，例如 fa fa-user，如输入正确右侧区会自动预览" clearable>
								<el-button slot="append" :loading="iconLoading"><i :class="iconShow"></i></el-button>
							</el-input>
						</el-form-item>
					</el-row>
					<el-row>
						<el-form-item v-if="menu.type == 2" prop="perms" label="授权标识">
							<el-input v-model.trim="menu.perms" placeholder="例如：sys:user:view" clearable></el-input>
						</el-form-item>
					</el-row>
					<el-row>
						<el-form-item v-if="menu.type != 2" prop="orderNum" label="排序号">
							<el-input-number v-model="menu.orderNum" :min="0" :max="20"></el-input-number>
						</el-form-item>
					</el-row>
				</el-form>
			</el-card>
		</div>
		<div id="parmsDialog" class="layui-dialog">
			<el-card>
				<el-form :model="parmsMenu" label-width="80px">
					<el-row>
						<el-col :span="12">
							<el-form-item label="菜单名称">
								<span class="layui-badge layui-bg-cyan">{{parmsMenu.name}}</span>
							</el-form-item>
						</el-col>
						<el-col :span="12">
							<el-form-item label="菜单URL">
								<span class="layui-badge layui-bg-cyan">{{parmsMenu.url}}</span>
							</el-form-item>
						</el-col>
					</el-row>
				</el-form>
				<el-row>
					<fieldset class="layui-elem-field layui-field-title">
						<legend>批量授权</legend>
						<div class="layui-field-box">
							<el-row>
								<el-button type="primary" size="mini"><i class="fa fa-plus"></i>&nbsp;添加</el-button>
								<el-button type="primary" size="mini"><i class="fa fa-plus"></i>&nbsp;自动生成</el-button>
							</el-row>
							<br />
							<template v-for="(item, index) in parmsObjList">
								<el-row :gutter="5">
									<el-col :span="4">
										<el-input placeholder="名称" v-model="item.name"></el-input>
									</el-col>
									<el-col :span="10">
										<el-input placeholder="授权标识" v-model="item.parms"></el-input>
									</el-col>
									<el-col :span="4">
										<el-input placeholder="排序号" v-model="item.order"></el-input>
									</el-col>
									<el-col :span="2">
										<el-button type="danger" size="mini"><i class="fa fa-trash-o"></i></el-button>
									</el-col>
								</el-row>
								<br />
							</template>
						</div>
					</fieldset>
				</el-row>
			</el-card>
		</div>
	</div>
	<script src="/js/module/menu.js${time}"></script>
</body>

</html>